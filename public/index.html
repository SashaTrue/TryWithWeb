<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Holy Days - главная</title>
  <link rel="stylesheet" href="./stylesheets/style.css">
</head>
<body>
<nav class="navbar">
  <a href="/" class="logo">
    <img src="./images/logo/SaintChel.png" alt="Holy Days Icon">
    <span>Holy Days</span>
  </a>
  <!-- Кнопка входа через GitHub или кнопка с никнеймом -->
  <a id="auth-btn" href="/auth/github" class="github-login-btn">Войти через GitHub</a>
</nav>

<div class="nav-container">
  <div class="nav-links">
    <a href="/holidays-by-date">По дате</a>
    <a href="/holidays-by-category">По категориям</a>
  </div>
</div>

<div id="holidays-container"></div>

<script>
  // Функция для получения данных о текущем пользователе
  async function getUserData() {
    const response = await fetch('/user');
    const data = await response.json();

    const authBtn = document.getElementById('auth-btn');
    if (data.username) {
      // Меняем кнопку на никнейм и аватарку
      authBtn.innerHTML = `
        <img src="${data.avatar_url}" alt="Avatar" class="avatar">
        ${data.username} (Выход)
      `;
      authBtn.href = '/logout'; // Меняем ссылку на выход
    } else {
      authBtn.textContent = 'Войти через GitHub'; // Если не авторизован
      authBtn.href = '/auth/github'; // Ссылка на вход
    }
  }

  // Вызов функции при загрузке страницы
  getUserData();

  // Получение данных с сервера о праздниках
  async function fetchHolidays() {
    const response = await fetch('/holidays');
    const html = await response.text();
    document.getElementById('holidays-container').innerHTML = html;
  }
  fetchHolidays();

  // Обработчик клика на мероприятие
  function showHolidayDetails(holidayId) {
    window.location.href = `/holiday-details?id=${holidayId}`; // Перенаправление на страницу с параметром ID
  }
</script>
</body>
</html>
